<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>FCKeditor2.6.3与FCKeditor.java2.4在JSP中配置</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<link rel="stylesheet" href="../../stylesheets/stylesheet.css" media="screen">
	<link rel="stylesheet" href="../../stylesheets/pygment_trac.css"/>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	<script type="text/javascript" src="../../javascripts/script.js"></script>
	
	<meta name="description" content="firstfhy">
	
	<meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
	<div class="wrapper">
		<div id="container">
		    <div id="main" role="main">
		    	<div class="download-bar">
			    	<div class="inner">
			          	<a class="code">JAVA</a>
			        </div>
		        	<span class="blc"></span><span class="trc"></span>
		        </div>
		        <article class="markdown-body">
					<h3>
						FCKeditor2.6.3与FCKeditor.java2.4在JSP中配置
				   	</h3>
<div id="blogDetailDiv" style="font-size:14px;">
                                                
                                                .FCKeditor 介绍FCKeditor 这个开源的HTML 文本编辑器可以让web 程序拥有如MS Word 这样强大的编辑功能，.FCKeditor 支持当前流行的浏览器如 ，先抓个图让大家一睹她的芳容:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br/>各位不要怀疑这是从OFFICE2003上抓的图哦，等您把这篇文章看完之后在您的网也中也可以拥有这样的效果了哦^_^，废话少说，转到正题。<br/>2．准备工作：<br/>环境：winddows XP、tomcat6.0、JDK1.6<br/>下载：<br/>1）：FCKeditor_2.6.3b.zip<br/>地址：<a href="http://nchc.dl.sourceforge.net/sourceforge/fckeditor/FCKeditor_2.6.3b.zip" target="_blank"><span style="color:#000000;line-height:1.8em;">http://nchc.dl.sourceforge.net/sourceforge/fckeditor/FCKeditor_2.6.3b.zip</span><wbr/></a><wbr/><br/>2）：fckeditor-java-2.4-bin.zip （JAVA支持包）地址<a href="http://nchc.dl.sourceforge.net/sourceforge/fckeditor/fckeditor-java-2.4-bin.zip" target="_blank"><span style="color:#000000;line-height:1.8em;">http://nchc.dl.sourceforge.net/sourceforge/fckeditor/fckeditor-java-2.4-bin.zip</span><wbr/></a><wbr/><br/>3）slf4j-1.5.2.zip 地址 ：<a href="http://slf4j.org/dist/slf4j-1.5.2.zip" target="_blank"><span style="color:#000000;line-height:1.8em;">http://slf4j.org/dist/slf4j-1.5.2.zip</span><wbr/></a><wbr/><br/>3.安装：<br/>1）解压FCKeditor_2.6.3b.zip，将解压的到的fckeditor整个文件夹完整复制到工程目录WebRoot下。<br/>2）解压fckeditor-java-2.4-bin.zip，在fckeditor-java-2.4-bin的解压缩文件中提取出4个JAR包，分别为fckeditor-java-core-2.4.jar、commons-fileupload-1.2.1.jar、commons-io-1.3.2.jar、slf4j-api-1.5.2.jar，<br/>3）解压slf4j-1.5.2.zip，只需提取slf4j-jdk14-1.5.2.jar包<br/>4）将2、3步提取的5个包都都导如工程目录WEB-INF/bin中<br/>（<br/>插句题外话，刚开始我只导入了第2步截压出的4个包，启动TOMCAT的时候提示找不到类org.slf4j.impl.StaticLoggerBider，再看官方文档，上面说还要下SLF4J，于是便到slf4j官网下了个最新版，但不知道org.slf4j.impl.StaticLoggerBider类在哪个包里，这是我最笨之处，我将所有包都导进去慢慢找（汗……），然后把多余包给移除了（通过项目右键→Properties→Java Build Path→Libraries，移除多余包），再重启，现在不报找不到类的错了，但出现了上百条java.lang.StackOverflowError错误（再汗……），查了N久，没结果，然后在MyEclipse的lib目录下还发现了一大堆刚才移除的包，接着我就把他们统统右键Delete删除，再重启，嘿嘿，OK了。<br/>）<br/>4.配置<br/>1)在共程目录src/下新建一个文件fckeditor.properties，添加内容：connector.userActionImpl=net.fckeditor.requestcycle.impl.UserActionImpl 保存即可。<br/>2)修改web.xml，用来提供上传功能支持，<br/>添加内容：<br/>&lt;servlet&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-name&gt;Connector&lt;/servlet-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-class&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;net.fckeditor.connector.ConnectorServlet<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/servlet-class&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;load-on-startup&gt;1&lt;/load-on-startup&gt;<br/>&lt;/servlet&gt;<br/>&lt;servlet-mapping&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-name&gt;Connector&lt;/servlet-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;url-pattern&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/fckeditor/editor/filemanager/connectors/*<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/url-pattern&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/servlet-mapping&gt;<br/>5.应用<br/>在工程目录WebRoot下新建index.jsp,result.jsp两个文件，<br/>index.jsp:<br/>&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;<br/>&lt;%@ taglib uri=&quot;<a href="http://java.fckeditor.net/" target="_blank"><span style="color:#000000;line-height:1.8em;">http://java.fckeditor.net</span><wbr/></a><wbr/>&quot; prefix=&quot;FCK&quot; %&gt;<br/>&lt;%<br/>String path = request.getContextPath();<br/>String basePath = request.getScheme()+&quot;://&quot;+request.getServerName()+&quot;:&quot;+request.getServerPort()+path+&quot;/&quot;;<br/>%&gt;<br/>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;base href=&quot;&lt;%=basePath%&gt;&quot;&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;FCKeditor.java2.4 for FCKeditor2.6.3Beate text&lt;/title&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;<br/>&lt;meta http-equiv=&quot;pragma&quot; content=&quot;no-cache&quot;&gt;<br/>&lt;meta http-equiv=&quot;cache-control&quot; content=&quot;no-cache&quot;&gt;<br/>&lt;meta http-equiv=&quot;expires&quot; content=&quot;0&quot;&gt;&nbsp;&nbsp; <br/>&lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt;<br/>&lt;meta http-equiv=&quot;description&quot; content=&quot;This is my page&quot;&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;form action=&quot;result.jsp&quot; method=&quot;post&quot;&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;FCK:editor instanceName=&quot;content&quot;&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;jsp:attribute name=&quot;value&quot;&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;您的内容.....<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/jsp:attribute&gt;<br/>&lt;/FCK:editor&gt;<br/>&lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br/>&nbsp;&nbsp; <br/>&lt;/body&gt;<br/>&lt;/html&gt;<br/>result.jsp<br/>&lt;%@ page language=&quot;java&quot; import=&quot;java.util.*&quot; pageEncoding=&quot;UTF-8&quot;%&gt;<br/>&lt;%<br/>String path = request.getContextPath();<br/>String basePath = request.getScheme()+&quot;://&quot;+request.getServerName()+&quot;:&quot;+request.getServerPort()+path+&quot;/&quot;;<br/>%&gt;<br/>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;base href=&quot;&lt;%=basePath%&gt;&quot;&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;My JSP 'result.jsp' starting page&lt;/title&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;<br/>&lt;meta http-equiv=&quot;pragma&quot; content=&quot;no-cache&quot;&gt;<br/>&lt;meta http-equiv=&quot;cache-control&quot; content=&quot;no-cache&quot;&gt;<br/>&lt;meta http-equiv=&quot;expires&quot; content=&quot;0&quot;&gt;&nbsp;&nbsp; <br/>&lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt;<br/>&lt;meta http-equiv=&quot;description&quot; content=&quot;This is my page&quot;&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&lt;%=request.getParameter(&quot;content&quot;) %&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;<br/>在IE地址中输入：<a href="http://localhost:8080/FCKtest" target="_blank"><span style="color:#000000;line-height:1.8em;">http://localhost:8080/FCKtest</span><wbr/></a><wbr/>&nbsp;&nbsp;&nbsp;&nbsp;OK,成功了！<br/>6．不足之处<br/>1） 在文本框中输入中文提交后得到的中文乱码。<br/>解决办法：<br/>Result.JSP中来转码：<br/>new String(request.getParameter(“content”).getByte(iso-8859-1),”UTF-8”)<br/>试验下，嘿嘿，”汉化”成功！<br/>2） 上传中文名图片后保存的中文图片名乱码<br/>解决办法：下载<a href="http://www.pjwqh.cn.jar/" target="_blank"><span style="color:#000000;line-height:1.8em;">www.pjwqh.cn.jar</span><wbr/></a><wbr/>包，替换以前下载的fckeditor-java-core-2.4.jar包，<br/>OK，上传中文图片名显示正常了，<br/>3） 点击浏览服务器后，选择刚上传的中文图片，图片在预览窗口中不能显示<br/>解决办法：<br/>修改TOMCAT安装目录config下的server.xml文件，在&lt;Connector/&gt;标签内加上 URIEncoding=&quot;UTF-8&quot;。<br/>OK，中文图片正常显示。<br/>4） 关与FLASH的上传<br/>A.上传中文文件名FLASH时，有时候弹出没有权限，或者是文件类型错误，有时候上传正常。<br/>B.上传英文或者数字名FLASH时，窗口一直处与等待状态，过一会儿关闭窗口，再通过浏览服务器按钮可以看到FLASH已经成功上传。<br/>C.有时候如过上传成功了，预览窗口也不能播放。<br/>D．有时候无论使用什么语言的文件名都可以上传成功。<br/>但只要你是使用的英文或则数字文件名，就能100%上传。<br/>所以关于这个问题估计还是编码引起的。<br/>5）。FCKeditor2.6.2上传文件功能与Struts 2 不兼容的问题。<br/>解决办法：<br/>让Struts2仅处理*.action的请求。修改配置文件web.xml:<br/>将Struts2处理所有web请求的过滤器配置<br/>&lt;filter-mapping&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-name&gt;struts2&lt;/filter-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;url-pattern&gt;/*&lt;/url-pattern&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/filter-mapping&gt;<br/>改为：仅处理.action或.jsp请求<br/>&lt;filter-mapping&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-name&gt;struts2&lt;/filter-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;url-pattern&gt;*.action&lt;/url-pattern&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/filter-mapping&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;filter-mapping&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-name&gt;struts2&lt;/filter-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/filter-mapping&gt;<br/>备注：以上配置文件的更改会造成Struts2 标签在页面中不显示<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 应该在web.xml文件中加入以下配置：<br/>&lt;filter-mapping&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;filter-name&gt;struts2&lt;/filter-name&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;url-pattern&gt;/struts/*&lt;/url-pattern&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/filter-mapping&gt;<br/>附：FCKeditor的编码是个老大难，想真正让他很好的处理中文是件非常不容易的事情，例如上面费了好大劲将中文名图片的上传和浏览功能修改好之后，FLASH又出问题。这些都是编码惹的祸。<br/>这里附上另外一种解决办法，可以屏蔽掉上面不足之处的1、2、3、4部的操作，下载FCKeditor2.4ByTxdnet.Cn.jar这个包，用来替换上面的<a href="http://www.pjwqh.cn.jar/" target="_blank"><span style="color:#000000;line-height:1.8em;">www.pjwqh.cn.jar</span><wbr/></a><wbr/>包，剩下的工作就是等着你测试了，这个方法方便、简单、有校，他解决中文乱码的原理是将上传的文件无论是中文文件名或者英文文件名改用系统当前时间来替换，既改成了数字，这样就永远不存在乱码和图片无法显示的问题了。（本方法又Happy漫步者提供）<br/>7．总结：<br/>FCKeditor2.6.3 Beta在2.6.2基础上有了很大改进，FCKeidtor 2.6.3Beta在配置上进行了大量简化，让使用者更易轻松上手，但FCKeditor的编码是个老大难问题，特别在文件上传功能上表现的尤为突出，希望FCK官方在以后的版本中能够修正这个BUG。<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                
                                            </div>

				</article>
			</div>
		</div>
	    <footer>
			<div class="owner">
				<p><a href="https://github.com/firstfhy" class="avatar"><img src="https://avatars0.githubusercontent.com/u/10542465?v=3&amp;s=60" width="48" height="48"></a>View <a href="https://github.com/firstfhy">firstfhy</a> on <a href="https://www.github.com">GitHub</a></p>
			</div>
			<div class="creds">
			  	<small>This page generated using <a href="http://pages.github.com/">GitHub Pages</a><br>theme by <a href="https://twitter.com/jonrohan/">Jon Rohan</a></small>
			</div>
	    </footer>
	</div>
</body>
</html>
